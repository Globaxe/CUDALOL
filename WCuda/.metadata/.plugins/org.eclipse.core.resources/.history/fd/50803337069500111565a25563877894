#include "Indice2D.h"
#include "cudaTools.h"
#include "Device.h"

/*----------------------------------------------------------------------*\
 |*			Declaration 					*|
 \*---------------------------------------------------------------------*/

/*--------------------------------------*\
 |*		Imported	 	*|
 \*-------------------------------------*/

extern __global__ void toGray(uchar4* ptrDev1_image, int w, int h);

/*--------------------------------------*\
 |*		Public			*|
 \*-------------------------------------*/

void modifyImage(uchar4* ptrDev0_Image, int w, int h,cudaStream_t stream=0);// 0 stream par default

/*--------------------------------------*\
 |*		Private			*|
 \*-------------------------------------*/

/*----------------------------------------------------------------------*\
 |*			Implementation 					*|
 \*---------------------------------------------------------------------*/

/*--------------------------------------*\
 |*		Public			*|
 \*-------------------------------------*/

void modifyImage(uchar4* ptrDev0_Image, int w, int h,cudaStream_t stream)
    {
    dim3 blockPerGrid = dim3(8, 8, 1);
    dim3 threadPerBlock = dim3(16, 16, 1);

   // print(blockPerGrid, threadPerBlock);
    //Device::assertDim(blockPerGrid, threadPerBlock);

    toGray    <<<blockPerGrid,threadPerBlock,0,stream>>>(ptrDev0_Image, w, h); // paramètre 3 : spécifier le nombre d'octets en mémoire partagée alloués dynamiquement par bloc en plus de la mémoire allouée statiquement; 0 valeur par defaut
    }

/*--------------------------------------*\
 |*		Private			*|
 \*-------------------------------------*/



/*----------------------------------------------------------------------*\
 |*			End	 					*|
 \*---------------------------------------------------------------------*/

